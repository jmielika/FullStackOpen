{"ast":null,"code":"import _objectSpread from\"/home/jmielika/Kurssit/FullStackOpen/osa-3/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/jmielika/Kurssit/FullStackOpen/osa-3/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import personsService from'./services/persons';import Persons from'./components/Persons';import FilterForm from'./components/FilterForm';import PersonForm from'./components/PersonForm';import Notification from'./components/Notification';var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newPhoneNumber=_useState6[0],setNewPhoneNumber=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),nameFilter=_useState8[0],setNameFilter=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var handleFilterChange=function handleFilterChange(event){setNameFilter(event.target.value);};useEffect(function(){personsService.getAll().then(function(initialPersons){setPersons(initialPersons);});},[]);var addPerson=function addPerson(event){event.preventDefault();var personObject={name:newName,number:newPhoneNumber};var checkPersonOccurrency=persons.filter(function(person){return person.name.toLocaleLowerCase()===newName.toLocaleLowerCase();});console.log(checkPersonOccurrency);if(checkPersonOccurrency.length===1){console.log(checkPersonOccurrency[0].id);personObject=_objectSpread(_objectSpread({},personObject),{},{id:checkPersonOccurrency[0].id});}if(checkPersonOccurrency.map(function(person){return person.name.toLocaleLowerCase;}).includes(newName.toLocaleLowerCase,0)){if(window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\"))){console.log(\"\".concat(personObject.name,\" is added, changing number\"));personsService.update(personObject.id,personObject).then(function(returnedPerson){setPersons(persons.map(function(personOrig){return personOrig.id!==personObject.id?personOrig:returnedPerson;}));}).catch(function(error){setPersons(persons.filter(function(person){return person.id!==personObject.id;}));setErrorMessage({message:\"Information of \".concat(personObject.name,\" has already been removed from server\"),type:'errorUnsuccessful'});setTimeout(function(){setErrorMessage(null);},5000);});setErrorMessage({message:\"\".concat(personObject.name,\"'s number changed to \").concat(personObject.number),type:'errorSuccessful'});setTimeout(function(){setErrorMessage(null);},5000);}setNewName('');setNewPhoneNumber('');}else{console.log(\"\".concat(personObject.name,\" is a new person, adding person to the database\"));personsService.create(personObject).then(function(returnedPerson){setPersons(persons.concat(returnedPerson));setNewName('');setNewPhoneNumber('');});setErrorMessage({message:\"\".concat(personObject.name,\" and their number \").concat(personObject.number,\" added to the phonebook\"),type:'errorSuccessful'});setTimeout(function(){setErrorMessage(null);},5000);}};var handleNameAdd=function handleNameAdd(event){setNewName(event.target.value);};var handlePhoneNumberAdd=function handlePhoneNumberAdd(event){setNewPhoneNumber(event.target.value);};var handleDeletePerson=function handleDeletePerson(id){var personOfId=persons.filter(function(person){return person.id===id;})[0];if(window.confirm(\"Delete \".concat(personOfId.name,\"?\"))){personsService.deletePerson(id).then(function(){setPersons(persons.filter(function(person){return person.id!==id;}));setErrorMessage({message:\"\".concat(personOfId.name,\" and their number \").concat(personOfId.number,\" deleted from the phonebook\"),type:'errorSuccessful'});setTimeout(function(){setErrorMessage(null);},5000);});}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Phonebook\"),/*#__PURE__*/React.createElement(Notification,{errorMessage:errorMessage}),/*#__PURE__*/React.createElement(FilterForm,{onChange:handleFilterChange,nameFilter:nameFilter}),/*#__PURE__*/React.createElement(\"h3\",null,\"add a new\"),/*#__PURE__*/React.createElement(PersonForm,{onSubmit:addPerson,name:newName,onNameChange:handleNameAdd,phoneNumber:newPhoneNumber,onNumberChange:handlePhoneNumberAdd}),/*#__PURE__*/React.createElement(\"h2\",null,\"Numbers\"),/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(Persons,{persons:persons,nameFilter:nameFilter,handleDeletePerson:handleDeletePerson})));};export default App;","map":{"version":3,"sources":["/home/jmielika/Kurssit/FullStackOpen/osa-3/phonebook/src/App.js"],"names":["React","useState","useEffect","personsService","Persons","FilterForm","PersonForm","Notification","App","persons","setPersons","newName","setNewName","newPhoneNumber","setNewPhoneNumber","nameFilter","setNameFilter","errorMessage","setErrorMessage","handleFilterChange","event","target","value","getAll","then","initialPersons","addPerson","preventDefault","personObject","name","number","checkPersonOccurrency","filter","person","toLocaleLowerCase","console","log","length","id","map","includes","window","confirm","update","returnedPerson","personOrig","catch","error","message","type","setTimeout","create","concat","handleNameAdd","handlePhoneNumberAdd","handleDeletePerson","personOfId","deletePerson"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport personsService from './services/persons'\n\nimport Persons from './components/Persons'\nimport FilterForm from './components/FilterForm'\nimport PersonForm from './components/PersonForm'\nimport Notification from './components/Notification'\n\n\n\nconst App = () => {\n  const [ persons, setPersons] = useState([]) \n  const [ newName, setNewName ] = useState('')\n  const [ newPhoneNumber, setNewPhoneNumber ] = useState('')\n  const [ nameFilter, setNameFilter] = useState('')\n  const [ errorMessage, setErrorMessage] = useState(null)\n\n  const handleFilterChange = (event) => {\n      setNameFilter(event.target.value)\n  }\n\n\n\n  useEffect(() => {\n    personsService\n      .getAll()\n      .then(initialPersons => {\n        setPersons(initialPersons)\n      }) \n    }, [])\n\n\n\n  const addPerson = (event) => {\n    event.preventDefault()\n  \n    let personObject ={\n      name: newName,\n      number: newPhoneNumber\n    }    \n\n    const checkPersonOccurrency = persons.filter(person => person.name.toLocaleLowerCase() === newName.toLocaleLowerCase())\n    console.log(checkPersonOccurrency)\n    if (checkPersonOccurrency.length === 1) {\n      console.log(checkPersonOccurrency[0].id)\n       personObject = {...personObject, id: checkPersonOccurrency[0].id}\n    }\n\n    if (checkPersonOccurrency.map(person => person.name.toLocaleLowerCase).includes(newName.toLocaleLowerCase, 0)) {\n      if (window.confirm(`${newName} is already added to phonebook, replace the old number with a new one?`)) {\n\n        console.log(`${personObject.name} is added, changing number`)\n\n        personsService\n          .update(personObject.id, personObject)\n          .then(returnedPerson => {\n            setPersons(persons.map(personOrig => personOrig.id !== personObject.id ? personOrig : returnedPerson))\n          })\n          .catch(error => {\n            setPersons(persons.filter(person => person.id !== personObject.id))\n            setErrorMessage({ message: `Information of ${personObject.name} has already been removed from server`, type: 'errorUnsuccessful'})\n            setTimeout(() => {\n            setErrorMessage(null)\n        }, 5000)\n          })  \n        setErrorMessage({ message: `${personObject.name}'s number changed to ${personObject.number}`, type: 'errorSuccessful'})\n        setTimeout(() => {\n          setErrorMessage(null)\n        }, 5000)\n      } \n\n      setNewName('')\n      setNewPhoneNumber('')\n\n    } else {\n      console.log(`${personObject.name} is a new person, adding person to the database`)\n      personsService\n        .create(personObject)\n        .then(returnedPerson => {\n          setPersons(persons.concat(returnedPerson))\n          setNewName('')\n          setNewPhoneNumber('')\n        })\n      setErrorMessage({\n        message: `${personObject.name} and their number ${personObject.number} added to the phonebook`,\n        type: 'errorSuccessful'\n      })\n      setTimeout(() => {\n        setErrorMessage(null)\n      }, 5000)\n      }    \n  }\n\n  const handleNameAdd = (event) => {\n    setNewName(event.target.value)\n  }\n\n  \n  const handlePhoneNumberAdd =(event) => {\n    setNewPhoneNumber(event.target.value)\n  }\n\n  const handleDeletePerson = (id) => {\n    const personOfId = persons.filter(person => person.id === id)[0]\n    if (window.confirm(`Delete ${personOfId.name}?`)) {\n      personsService\n        .deletePerson(id)\n        .then(() => {\n          setPersons(persons.filter(person => person.id !== id))\n          setErrorMessage({\n            message: `${personOfId.name} and their number ${personOfId.number} deleted from the phonebook`,\n            type: 'errorSuccessful'\n          })\n          setTimeout(() => {\n            setErrorMessage(null)\n          }, 5000)\n        })\n      \n    }\n  }\n  \n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      <Notification errorMessage={errorMessage} />\n      <FilterForm onChange={handleFilterChange} nameFilter={nameFilter}/>\n        \n      <h3>add a new</h3>\n      <PersonForm onSubmit={addPerson} name={newName} onNameChange={handleNameAdd} phoneNumber={newPhoneNumber} onNumberChange={handlePhoneNumberAdd} />\n      <h2>Numbers</h2>\n      <ul>\n        <Persons\n            persons={persons}\n            nameFilter={nameFilter}\n            handleDeletePerson={handleDeletePerson} />\n      </ul>\n    </div>\n  )\n\n  }\n\nexport default App"]},"metadata":{},"sourceType":"module"}